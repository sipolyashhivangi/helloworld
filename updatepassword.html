<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>FlexScore - Change Password
        </title>
        <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
        <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
        <meta name="description" content="FlexScore gives you total financial clarity wrapped up in a single score. It's fast, free, and even a little fun.">
        <meta name="author" content="FlexScore">
        <meta name="keywords" content="">
        <meta property="og:title" content="FlexScore - Change Password">
        <meta property="og:url" content="https://www.flexscore.com/updatepassword">
        <meta property="og:locale" content="en_US">
        <meta property="og:description" content="FlexScore gives you total financial clarity wrapped up in a single score. It's fast, free, and even a little fun.">
        <meta property="og:image" content="https://www.flexscore.com/ui/images/home_laptop.png">
        <meta content="u3kX0jqV2_YEhCCIzKks2-P3Ws45R2ESrSsLQkRCiaQ" name="google-site-verification">
        <meta content="xZIdeyYAE_R97c0H6OGvkHeVWEI" name="alexaVerifyID">
        <meta name="msvalidate.01" content="1967933DCC3E8DF336994671EAAE77FD" />
        <link href="./ui/css/bootstrap/bootstrap.css" rel="stylesheet">
        <style type="text/css">body {padding-top: 60px;padding-bottom: 40px;}
        </style>
        <link rel="stylesheet" href="./ui/css/fonts.css" type="text/css">
        <link rel="stylesheet" href="./ui/css/bootstrap/flexscore.css?v=2" type="text/css" media="screen">
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
                <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
            <![endif]-->
        <!-- Fav and touch icons -->
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="ico/apple-touch-icon-144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png">
        <link rel="shortcut icon" href="./ui/images/favicon.png">
    </head>
    <body id="body">
        <input type="hidden" id="currentPage" value="forgotpassword">
        <div class="container col750" >
            <div style="padding:0px 0px 5px 5px;width:160px;font-size:0.9em">
                <a href="./">
                    <img width="160" alt="FlexScore Logo" src="./ui/images/logo-color-trans.png" style="width:160px" /></a>
                <br>
                <div class="clearOnly"></div>
            </div>
            <!-- TABBED CONTENT -->
            <div id="signIn" class="row-fluid">
                <div class="content tab-content">

                    <!-- SIGN IN TAB -->
                    <div class="tab-pane fade active in" style="padding:10px 10px 5px 5px" id="loginUser">
                        <form class="form-horizontal">
                            <input type="hidden" name="token" id="token"/>
                            <div class="failVerifyTitleArea signupTitleArea" style="display:none">
                                <h1>Error!</h1>
                                <p style="margin:1em 0;padding:0px 10px">Unable to verify. The verification url is either expired or invalid verification code found.</p>
                            </div>

                            <div class="successVerifyTitleArea" style="display:none">
                                <div class="signupTitleArea">
                                    <h1>Change Password</h1>
                                    <p style="margin:1em 0;padding:5px 10px" id="forgotInstructions"></p>
                                </div>
                                <div class="clearOnly">&nbsp;</div>
                                <div class="control-group">
                                    <label class="signupFormLabel control-label" for="inputPassword"><strong>Password</strong>
                                    </label>
                                    <div class="controls" id="password1div">
                                        <input type="password" id="password1" placeholder="Password">
                                        <div id="password1bubble" class="errorBubble hdn">
                                            <div class="inside">
                                                <p id="password1error"></p>
                                                <div class="point">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="signupFormLabel control-label" for="inputConfirmPassword"><strong>Confirm Password</strong>
                                    </label>
                                    <div class="controls">
                                        <input type="password" id="password2" placeholder="Password">
                                    </div>
                                    <div class="control-group" style="padding: 5px 20px 0px 180px; font-size:13px;">
                                       Passwords must be at least eight characters in length with no spaces and include at least one uppercase letter, lowercase letter, symbol, and number.
                                    </div>
                                <div class="control-group">
                                    <div class="controls">
                                        <button id="pupdateButton" type="submit" class="simpleGreenCTAButton">Change Password
                                        </button>&nbsp;&nbsp;<a class="cancelPopup" href="#"><strong>Cancel</strong></a>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="clearEverything">
                </div>
            </div>
            <div class="clearEverything">&nbsp;
            </div>
            <!-- END TABBED CONTENT -->
            <div id="footerSignup">
                <div>
                    <div class="secureGuarantee floatL">
                    </div>
                    <div class="floatL" style="width:90%">
                        <strong>Secure Guarantee</strong><br />FlexScore is fully-equipped with 256-bit SSL encryption. That's the same level of security your bank or broker uses.
                    </div>
                    <div class="clearOnly"></div>
                </div>
                <div>
                    <a title="Click to Verify - This site has chosen a VeriSign SSL Certificate to improve Web site security" class="verisignSSL" href="https://sealinfo.verisign.com/splash?form_file=fdf/splash.fdf&amp;dn=www.flexscore.COM&amp;lang=en" target="_blank" style>
                        <img width="125" src="./ui/images/norton.png" alt="Verisign SSL Certificate" style="width:125px" />
                    </a>
                    &nbsp;
                    <a target="_blank" href="https://www2.mcafeesecure.com/verify?host=www.flexscore.com">
                        <img class="mfes-trustmark" style="border:0" src="//cdn.ywxi.net/meter/www.flexscore.com/101.gif" width="125" height="55" title="McAfee SECURE sites help keep you safe from identity theft, credit card fraud, spyware, spam, viruses and online scams" alt="McAfee SECURE sites help keep you safe from identity theft, credit card fraud, spyware, spam, viruses and online scams" oncontextmenu="alert('Copying Prohibited by Law - McAfee Secure is a Trademark of McAfee, Inc.'); return false;">
                    </a>
                </div>
            </div>
        </div>
        <br>
        <div class="slider">
        </div>

        <!-- Le javascript
                ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/javascript" src="./ui/js/libs/jquery/jquery-min.js"></script>
        <script type="text/javascript">
            function getParameter(paramName) {
                var searchString = window.location.search.substring(1),
                        i, val, params = searchString.split("&");

                for (i = 0; i < params.length; i++) {
                    val = params[i].split("=");
                    if (val[0] == paramName) {
                        return val[1];
                    }
                }
                return null;
            }

            function PositionErrorMessage(element, error)
            {
                var elementwidth = $(element).width();
                var errorwidth = $(error).width();
                var elementheight = $(element).height();
                var errorheight = $(error).height();
                var elementoffset = $(element).offset();
                var erroroffset = $(error).offset();
                var left = 10;
                var top = 0;
                if (error == "#termscheckbubble")
                {
                    left = 14;
                    top = 5;
                }
                if (typeof (elementoffset) != "undefined") {
                    $(error).offset({
                        top: elementoffset.top - errorheight - 18 - top,
                        left: (elementwidth - errorwidth) / 2 + elementoffset.left - left
                    });
                }
            }
            $(document).ready(function() {
                if (getParameter('token').length > 0) {
                    var resetUrlToBeUsed;
                    resetUrlToBeUsed = "service/api/resetverify" + "?token=" + getParameter('token');
                    if (window.location.search.indexOf("type=advisor") != -1)
                    {
                        resetUrlToBeUsed = "service/api/resetverifyadvisor" + "?token=" + getParameter('token');
                    }
                    $.ajax({
                        url: resetUrlToBeUsed,
                        type: 'GET',
                        dataType: "json",
                        success: function(resetdata) {
                            if (resetdata.status == "ERROR") {
                                $(".failVerifyTitleArea").show();
                                $(".successVerifyTitleArea").hide();
                            } else {
                                $(".successVerifyTitleArea").show();
                                $('#token').val(getParameter('token'));
                                $(".cancelPopup").toggleClass("hdn");

                                $("body").on("click", "#pupdateButton", function(event) {

                                    event.preventDefault();
                                    $('#forgotButton').attr("disabled", "true");
                                    $('#alert-error').hide();

                                    var pass = $('#password1').val();
                                    var cpass = $('#password2').val();
                                    var token = $('#token').val();

                                    // START - client password validations
                                    var msg = 'Passwords must be at least eight characters in length with no spaces and include at least one uppercase letter, lowercase letter, symbol, and number.';
                                    if (pass != cpass) {
                                        $('#password1error').html('Passwords must match.');
                                        $('#password1bubble').removeClass("hdn");
                                        $("#password1div").addClass('error');
                                        PositionErrorMessage("#password1", "#password1bubble");
                                        $('#forgotButton').removeAttr("disabled");
                                        return false;
                                    }

                                    if (pass.length < 8 || cpass.length < 8 || pass.match(/\s/g) != null) {
                                        $('#password1error').html(msg);
                                        $('#password1bubble').removeClass("hdn");
                                        $("#password1div").addClass('error');
                                        PositionErrorMessage("#password1", "#password1bubble");
                                        $('#forgotButton').removeAttr("disabled");
                                        return false;
                                    }
                                    if (pass.search(/[a-z]/) == -1) {
                                        $('#password1error').html(msg);
                                        $('#password1bubble').removeClass("hdn");
                                        $("#password1div").addClass('error');
                                        PositionErrorMessage("#password1", "#password1bubble");
                                        $('#forgotButton').removeAttr("disabled");
                                        return false;
                                    }
                                    if (pass.search(/[A-Z]/) == -1) {
                                        $('#password1error').html(msg);
                                        $('#password1bubble').removeClass("hdn");
                                        $("#password1div").addClass('error');
                                        PositionErrorMessage("#password1", "#password1bubble");
                                        $('#forgotButton').removeAttr("disabled");
                                        return false;
                                    }
                                    if (pass.search(/[0-9]/) == -1) {
                                        $('#password1error').html(msg);
                                        $('#password1bubble').removeClass("hdn");
                                        $("#password1div").addClass('error');
                                        PositionErrorMessage("#password1", "#password1bubble");
                                        $('#forgotButton').removeAttr("disabled");
                                        return false;
                                    }
                                    if (pass.search(/[\W]/) == -1) {
                                        $('#password1error').html(msg);
                                        $('#password1bubble').removeClass("hdn");
                                        $("#password1div").addClass('error');
                                        PositionErrorMessage("#password1", "#password1bubble");
                                        $('#forgotButton').removeAttr("disabled");
                                        return false;
                                    }
                                    // END - client password validations

                                    var formValues = {
                                        password: pass,
                                        cpassword: cpass,
                                        token: token
                                    };

                                    var URLToBeUsed;
                                    var loginUrl;
                                    URLToBeUsed = "service/api/updatepassword";
                                    if (window.location.search.indexOf("type=advisor") != -1)
                                    {
                                        URLToBeUsed = "service/api/advisorupdatepassword";
                                        loginUrl = "./login?passwordrestflag=1&type=advisor";
                                    } else {
                                        loginUrl = "./login?passwordrestflag=1";
                                    }

                                    $.ajax({
                                        url: URLToBeUsed,
                                        type: 'POST',
                                        dataType: "json",
                                        data: formValues,
                                        success: function(data) {
                                            if (data.status == "ERROR")
                                            {
                                                $('#password1error').html(data.message);
                                                $('#password1bubble').removeClass("hdn");
                                                $("#password1div").addClass('error');
                                                PositionErrorMessage("#password1", "#password1bubble");
                                            }
                                            else if (data.status == "OK")
                                            {
                                                window.location.href = loginUrl;
                                            }
                                            return false;
                                        },
                                        error: function(data) {
                                            $('#password1error').html('Passwords must match.');
                                            $('#password1bubble').removeClass("hdn");
                                            $("#password1div").addClass('error');
                                            PositionErrorMessage("#password1", "#password1bubble");
                                        }
                                    });
                                    return false;

                                });
                            }
                        }
                    });
                }
            });
        </script>
    </body>
</html>